@using Quizard.Core.Entities
@using Quizard.WebApp.Services
@inject GameService GameService
@inject ILogger<QuestionButtons> Logger

@if (RoundStatistics is not null)
{
    <div class="col-12 p-5">
        <div class="row text-start">
            <div class="col-2"></div>
            <div class="col-3">
                @foreach (var statistic in RoundStatistics)
                {
                    <div class="row">
                        <div class="col">
                            <h3>@statistic.Player.Nickname</h3>
                        </div>
                    </div>
                }
            </div>
            <div class="col-1">
                @foreach (var statistic in RoundStatistics)
                {
                    <div class="row">
                        <div class="col">
                            <h3>@statistic.Score</h3>
                        </div>
                    </div>
                }
            </div>
            <div class="col-6"></div>
        </div>
    </div>
}

@code {
    private RoundStatistic[]? RoundStatistics { get; set; }

    protected override void OnInitialized()
    {
        GameService.OnChange += HandleGameServiceChanged;
    }

    private void HandleGameServiceChanged()
    {
        Logger.LogTrace("[Статистика Раунда] Состояние игры - {@G}", GameService);
        if (GameService.RoundStatistics != null)
        {
            RoundStatistics = GameService.RoundStatistics;
        }

        InvokeAsync(StateHasChanged);
    }

}