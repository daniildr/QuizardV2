# Quizard

#### Стандартизация JSON (RFC 8259)
Стандарт JSON однозначно определяет, что значение может быть либо числом, либо строкой (как и ещё несколько примитивных типов):

    “A JSON value MUST be an object, array, number, or string, or one of the following three literal names: false, null, true”
    datatracker.ietf.org

    То есть в терминах стандарта “0” (число) и "Warmup" (строка) оба являются валидными JSON-значениями.

# Структура игрового сценария Quizard Team

Документация описывает формат объекта сценария (`Scenario`) в системе Quizard Team. Сценарий задаётся JSON-объектом с набором полей и вложенных объектов (этапов, раундов, вопросов и т.д.). Ниже приведены разделы, соответствующие схеме из OpenAPI 3, а также примеры JSON-фрагментов.

## Общая структура сценария (Scenario)

Сценарий описывается объектом со следующими полями:

* **id** (string) – уникальный идентификатор сценария.
* **name** (string) – уникальное название сценария.
* **description** (string) – текстовое описание сценария.
* **gameDuration** (integer) – длительность сценария в минутах (необязательно, по умолчанию может быть любое).
* **basePointPrice** (integer) – стоимость базового игрового балла (например, 100). Обязательно указывать.
* **startPlayerScore** (integer) – стартовые очки у игрока (например, 0). Обязательно.
* **roundPresentationDuration** (integer) – время (в секундах) показа информации о раунде перед его началом (опционально).
* **showScenarioStatsOnFinish** (boolean) – флаг, показывать ли в конце игры общую статистику сценария. Обязательно.
* **finishPlaceholder** (string) – ссылка на финальный плейсхолдер (картинку/видео), показываемый после окончания игры.
* **placeholder** (string) – ссылка на общий плейсхолдер для экрана-информатора.
* **stages** (array of Stage) – список этапов сценария. Этот массив описывает последовательность действий (вступления, раунды и т.д.) в сценарии. Обязательное поле (может быть пустым).
* **roundDefinitions** (array of Round) – список возможных шаблонов раундов, которые игроки могут выбирать. Опционально, может быть пустым массивом.
* **shopStocks** (array of Stock) – конфигурация товаров/предметов в игровом магазине (используется в раундах с магазином). Опционально.
* **localization** (Localization) – объект локализации интерфейсных строк сценария (см. раздел «Локализация»). Обязательно указывать объект.

**Пример (сокращённый) JSON-сценария:**

```json
{
  "id": "scenario-demo",
  "name": "Демо-сценарий",
  "description": "Пример простого сценария",
  "gameDuration": 15,
  "basePointPrice": 100,
  "startPlayerScore": 0,
  "showScenarioStatsOnFinish": true,
  "stages": [
    { 
      "index": 1,
      "type": 1,
      "media": {
        "mediaId": "intro-video",
        "type": 2,
        "url": "/Video/intro.webm",
        "delaySeconds": 0,
        "showOnPlayer": false
      }
    },
    {
      "index": 2,
      "type": 2,
      "round": {
        "roundId": "round-1",
        "roundTypeId": 2,
        "name": "Супер Блиц",
        "previewUrl": "/Image/preview1.png",
        "correctMultiplier": 100,
        "missedMultiplier": 50,
        "incorrectMultiplier": 0,
        "questions": [ "вопросы" ]
      }
    }
  ],
  "localization": { "scenarioId": "scenario-demo", "buttonUp": "Вверх", "gameFinishLabel": "Конец игры" }
}
```

В этом примере заданы основные поля сценария, два этапа (приветствие и раунд), а также объект `localization`.

## Этапы (Stage)

Этапы (`Stage`) задают последовательность происходящего в сценарии. Каждый элемент массива `stages` – это объект:

* **index** (integer) – порядковый номер этапа (начиная с 1). Обязательно.
* **type** (integer) – тип этапа из перечисления `ScenarioStage` (целое от 0 до 5). Определяет, что происходит на этапе. Обязательно.
* **mediaId** (string) – внешний идентификатор медиа (опционально). Если указан, совпадает с `media.mediaId`.
* **media** (Media) – объект медиа (картинка/видео/аудио) для показа на этом этапе. Обязателен, если `type` предполагает показ медиа (например, приветствие).
* **roundId** (string) – идентификатор раунда из `roundDefinitions` или собственного раунда (опционально). Указывается для ссылок на раунд.
* **round** (Round) – объект раунда, который запускается на этом этапе. Если `type` соответствует игровому раунду, здесь задаётся его параметры (см. раздел «Раунды»).
* **stageDuration** (integer) – длительность этапа в секундах (например, задержка показа инфо) (опционально).

**Пример этапа:**
В сценарии может быть этап-представление и этап-раунд:

```json
{
  "index": 1,
  "type": 1,
  "media": {
    "mediaId": "welcome-video",
    "type": 2,
    "url": "/Video/welcome.webm",
    "delaySeconds": 0,
    "showOnPlayer": false
  }
},
{
  "index": 2,
  "type": 2,
  "roundId": "round-1",
  "round": { "см. пример раунда" }
}
```

Первый этап (type=1) показывает видео, второй (type=2) запускает раунд с `roundId="round-1"`.

## Раунды (Round)

Объект раунда описывает единицу игры внутри сценария. Поля `Round`:

* **roundId** (string) – уникальный идентификатор раунда (может быть любым).
* **scenarioId** (string) – идентификатор сценария (обязательно).
* **roundTypeId** (integer) – код типа раунда (цифровой ID механики, например, 2 = «Супер Блиц», 3 = «Горячая картошка»). Обязательно.
* **name** (string) – отображаемое название раунда.
* **description** (string) – пояснение/описание раунда.
* **previewUrl** (string) – ссылка на изображение-превью раунда.
* **roundDuration** (integer) – максимальная длительность раунда в секундах.
* **correctMultiplier** (integer) – множитель очков за правильный ответ.
* **missedMultiplier** (integer) – множитель очков за пропуск.
* **incorrectMultiplier** (integer) – множитель очков за неправильный ответ.
* **questions** (array of Question) – список вопросов раунда.

**Пример простого раунда:**

```json
{
  "roundId": "rnd-demo",
  "roundTypeId": 2,
  "name": "Блиц-раунд",
  "previewUrl": "/Image/blitz.png",
  "correctMultiplier": 100,
  "missedMultiplier": 50,
  "incorrectMultiplier": 0,
  "questions": [ "вопросы раунда" ]
}
```

В этом примере раунд «Блиц» имеет идентификатор `rnd-demo`, множители для подсчёта очков и массив вопросов.

## Вопросы и ответы (Question, Answer, Reveal, Hint)

**Вопрос** (`Question`) в составе раунда представлен объектом со следующими полями:

* **questionNumber** (integer) – порядковый номер вопроса в раунде. Обязательно.
* **questionText** (string) – текст вопроса.
* **mediaId** (string) – ID медиа (опционально).
* **media** (Media) – объект медиа для вопроса (изображение/видео/текст) (опционально).
* **answerDelay** (integer) – задержка (сек) перед показом вариантов ответов (опционально).
* **questionTimeout** (integer) – максимальное время (сек) на ответ данного вопроса. Обязательно.
* **answers** (array of Answer) – массив вариантов ответа.
* **reveal** (Reveal) – объект «правильного ответа» после ответа на вопрос.
* **hints** (array of Hint) – массив подсказок к вопросу (опционально).

Каждый **Answer** описывается так:

* **text** (string) – текст ответа.
* **button** (string) – код кнопки, которой игрок выбирает ответ (например, `"Numpad1 - Numpad6"`).
* **isCorrect** (boolean) – флаг, правильный ли это ответ (важно для вопросов с выбором).
* **order** (integer) – порядок ответа в последовательности (используется в специальных раундах, где ответы следует давать по очереди).

**Reveal** описывает, что показывается после ответа:

* **text** (string) – текст правильного ответа (например, «Правильный ответ – X»).
* **media** (Media) – можно указать медиа для отображения (опционально).
* **duration** (integer) – длительность показа в секундах.

**Hint** – простая подсказка:

* **text** (string) – текст подсказки.

**Пример вопроса и ответов:**

```json
{
  "questionNumber": 1,
  "questionText": "Какой самый большой океан на Земле?",
  "questionTimeout": 30,
  "answers": [
    { "text": "Тихий",       "button": "Numpad1", "isCorrect": true  },
    { "text": "Атлантический","button": "Numpad2", "isCorrect": false },
    { "text": "Индийский",    "button": "Numpad3", "isCorrect": false }
  ],
  "reveal": {
    "text": "Правильный ответ – Тихий океан",
    "duration": 5
  },
  "hints": [
    { "text": "Это самый обширный океан." }
  ]
}
```

В примере указан вопрос, три варианта ответов с клавишами `Numpad1…3`, правильный ответ и одна подсказка.

## Медиа (Media)

Объект `Media` описывает медиафайл (текст, изображение, видео, аудио). Поля:

* **mediaId** (string) – уникальный идентификатор медиа (опционально).
* **type** (integer) – тип медиа из перечисления `MediaType` (0–3). Обычно: 0=текст, 1=изображение, 2=видео, 3=звук.
* **url** (string) – ссылка на файл медиа (например, `"/Video/intro.webm"`). Опционально.
* **content** (string) – содержимое (например, текст) для типа «Текст». Используется, если нужно напрямую передать текст (в иных типах оставлять `null`).
* **delaySeconds** (integer) – задержка (сек) перед показом этого медиа (опционально).
* **duration** (integer) – длительность медиа в секундах (опционально, можно указать вручную или оставить `null`).
* **showOnPlayer** (boolean) – флаг, показывать ли медиа на экране игрока (если `false`, показывается только на «информаторе»).

**Пример использования медиа:**

```json
"media": {
  "mediaId": "question-image-1",
  "type": 1,
  "url": "/Image/question1.png",
  "delaySeconds": 1,
  "duration": 10,
  "showOnPlayer": true
}
```

Этот блок указывает, что на вопрос или этап будет показано изображение (type=1) по ссылке `question1.png`, с задержкой 1 секунда и длительностью 10 сек., отображающееся игрокам.

## Локализация (Localization)

Объект `Localization` содержит переводы и подписи для элементов интерфейса сценария. Поля – это строки для разных меток (кнопок, лейблов, подсказок). Все поля обязательны.

* **scenarioId** (string) – идентификатор сценария.
* **buttonUp**, **buttonDown**, **buttonConfirm**, **buttonCancel** (string) – подписи кнопок «Вверх», «Вниз», «Подтвердить», «Отмена».
* **scoreLabel**, **roundLabel**, **gameFinishLabel** (string) – подписи для «Счет», «Раунд», «Игра завершена».
* **hintLabel** (string) – заголовок для подсказок (например, «Подсказка»).
* **waitOtherPlayersLabel**, **waitYourTurnLabel** (string) – сообщения «Ожидание остальных игроков», «Ожидайте своей очереди».
* **shopTitle**, **priceLabel**, **insufficientFunds** и др. – подписи для интерфейса магазина.
* И т.д. – полный список полей большой (см. схему Localization).

**Пример объекта локализации:**

```json
"localization": {
  "scenarioId": "scenario-demo",
  "buttonUp": "Вверх",
  "buttonDown": "Вниз",
  "scoreLabel": "Счет",
  "gameFinishLabel": "Игра завершена"
}
```

💡 Более подробное описание типов всегда можно посмотреть в swagger-е в блоке Schemas - `{host ip}/swagger/index.html?urls.primaryName=Scenarios`